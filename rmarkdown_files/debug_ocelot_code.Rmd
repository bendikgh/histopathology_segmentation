---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.15.2
  kernelspec:
    display_name: specialization_project
    language: python
    name: python3
---

```{python}
# Fixing automatic autoreload
# %load_ext autoreload
# %autoreload 2
```

```{python}
import os 

# Making sure we are running the code from the root directory
current_directory = os.getcwd()
if current_directory.endswith("notebooks"):
    os.chdir("..")
    print("Changed directory to:", os.getcwd())
else:
    print("Directory was already correct, so did not change.")
```

```{python}
import json
import matplotlib.pyplot as plt
import numpy as np
import seaborn as sns

sns.set_theme()
```

```{python}
algorithm_output_path = "/cluster/work/jssaethe/histopathology_segmentation/ocelot23algo/test/output/cell_classification.json"
with open(algorithm_output_path, "r") as f:
    pred_json = json.load(f)["points"]

# Path where GT is stored
gt_path = "/cluster/work/jssaethe/histopathology_segmentation/cell_gt_test.json"
with open(gt_path, "r") as f:
    data = json.load(f)
    gt_json = data["points"]
    num_images = data["num_images"]
print(f"Number of images: {num_images}")
print(f"Number of prediction points: {len(pred_json)}")
print(f"Number of ground truth points: {len(gt_json)}")
```

```{python}
image_name = "image_1"

first_img_pred = []
for image in pred_json:
    if image["name"] == image_name:
        first_img_pred.append(image["point"])
first_img_gt = []
for image in gt_json:
    if image["name"] == image_name:
        first_img_gt.append(image["point"])
first_img_pred = np.array(first_img_pred)
first_img_gt = np.array(first_img_gt)
```

```{python}
plt.figure(figsize=(10, 5))
plt.subplot(1, 2, 1)
colors = np.where(first_img_pred[:, 2] == 1, 'blue', 'darkorange')
plt.scatter(first_img_pred[:, 0], first_img_pred[:, 1], c=colors, s=12)
plt.xlim(0, 1024)
plt.ylim(0, 1024)
plt.gca().set_aspect('equal', adjustable='box')
plt.title("Predictions")

plt.subplot(1, 2, 2)
colors = np.where(first_img_gt[:, 2] == 1, 'blue', 'darkorange')
plt.scatter(first_img_gt[:, 0], first_img_gt[:, 1], c=colors, s=12)
plt.xlim(0, 1024)
plt.ylim(0, 1024)
plt.gca().set_aspect('equal', adjustable='box')
plt.title("Ground truth")

plt.tight_layout()
plt.show()
```
