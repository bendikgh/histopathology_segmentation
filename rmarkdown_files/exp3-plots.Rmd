---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.15.2
  kernelspec:
    display_name: specialization_project
    language: python
    name: python3
---

```{python}
# Fixing automatic autoreload
# %load_ext autoreload
# %autoreload 2
```

```{python}
import os 

# Making sure we are running the code from the root directory
current_directory = os.getcwd()
if current_directory.endswith("notebooks"):
    os.chdir("..")
    print("Changed directory to:", os.getcwd())
else:
    print("Directory was already correct, so did not change.")
```

```{python}
import matplotlib.pyplot as plt
import seaborn as sns

sns.set_theme()
```

```{python}
# Losses and score for the tissue segmentation model, b0 - 1024
# path: outputs/logs/20240422_085251/Segformer_Tissue-Branch_backbone-b0.txt
tissue_training_losses = [0.7496763440966606, 0.6724011361598968, 0.5924427266418933, 0.5594490246474743, 0.5390779176354408, 0.5288978971540927, 0.5212824526429176, 0.5077875463664532, 0.5011393252015114, 0.503342279791832, 0.49298007547855377, 0.49010517105460166, 0.4855730889737606, 0.4813457711040974, 0.47610378548502924, 0.4751126442849636, 0.4744982462376356, 0.4699703425168991, 0.46827575117349624, 0.4723675152659416, 0.474744947552681, 0.4710279415547848, 0.4629278427362442, 0.4639441493153572, 0.4625116382539272, 0.45514436982572076, 0.4519872935116291, 0.45291143618524077, 0.45200193144381046, 0.44402154989540576, 0.44671522110700607, 0.44547309190034867, 0.4414562112092972, 0.4455273377150297, 0.4375622420758009, 0.44020758219063283, 0.44043748930096627, 0.4382328787446022, 0.43336557544767856, 0.43231781624257565, 0.4305527117848396, 0.43633054085075856, 0.42598419725894926, 0.4286018592864275, 0.4261561544984579, 0.42375788003206255, 0.4257092310488224, 0.4254801946878433, 0.422317361086607, 0.4221410570293665]
tissue_val_scores = [0.24893880416365233, 0.41492179649717664, 0.45079895415726834, 0.4663998988621375, 0.4703644829637864, 0.4650302248842576, 0.4876153872293585, 0.48671387530425014, 0.4926123868893174, 0.49993906126302834, 0.48482471923617754, 0.5059067326433518, 0.4998780833009411, 0.5077067646471893, 0.5136063537176918, 0.5066637466935551, 0.5132954041747486, 0.5151472827967476, 0.5387086461791221, 0.5245922098264975, 0.5122763144181055, 0.5145093820550862, 0.5466591638362255, 0.503548229661058, 0.5250985512838644, 0.5199916715569356, 0.5187221787431661, 0.514588699402178, 0.5158545835053219, 0.5236805705901455, 0.5107336129774065, 0.5281949678764624, 0.5194683375165743, 0.5303557517335695, 0.5233695745906409, 0.5195547333535027, 0.5226006207658964, 0.5201954208314419, 0.5252935209256762, 0.5244502767043955, 0.5196140178424471, 0.5276781250448788, 0.5340994721388115, 0.5297802099410225, 0.5232250085648369, 0.5455815860015505, 0.5263592364156948, 0.5229776891715386, 0.5206204021678251, 0.5336031543419641]
```

```{python}
# Losses for the cell-only model, b3 - 512
# path: outputs/logs/20240419_060504/Segformer_Cell-Only_backbone-b3.txt
cell_training_losses = [1.875000012102466, 1.4679241004934165, 0.9540006279340251, 0.7764441927677483, 0.7153985548745557, 0.6806725874770111, 0.6613745683340857, 0.6487440258113261, 0.6459561994838231, 0.6327547945346929, 0.6252553139241214, 0.6163232709248054, 0.6114324609640286, 0.6029165544485683, 0.5990129002762324, 0.5897726648047491, 0.5869498975990992, 0.5831681744096243, 0.5729304574770371, 0.5709604931059222, 0.5650371759373525, 0.5648236344308417, 0.5565399538139402, 0.5508306660325394, 0.5494766140044643, 0.5461866837467639, 0.5378780604013936, 0.5424166689366858, 0.5347163928341745, 0.5366503853483249, 0.5339971469138479, 0.5275462703958986, 0.5218850404477967, 0.5185474803302493, 0.5112540422357278, 0.5102609234110353, 0.514646008535085, 0.5069169936143807, 0.5045469093141217, 0.5048908332580238, 0.49984208188081153, 0.5006379805845658, 0.4978288014225548, 0.49574791704337606, 0.49185705018527615, 0.48724810408456676, 0.48286075353017316, 0.4868262641623541, 0.48445124008933904, 0.47799909508167787, 0.4779047872965711, 0.4755053539869144, 0.47756744595953654, 0.47704089308148107, 0.4736491095293597, 0.47226061116015244, 0.4714685351715475, 0.47022058379831655, 0.46665336955622366, 0.46874604688078014, 0.46352347746718353, 0.46341354819723796, 0.4602275104238297, 0.4626475860019626, 0.4615445798121128, 0.45664074638773344, 0.4553115626579614, 0.45424561905981925, 0.45253487438114764, 0.45300421829756143, 0.45081708379808416, 0.4468030277545077, 0.4484327092085998, 0.44906302885658245, 0.44474113184183384, 0.446476977261795, 0.444710546943742, 0.44408392527986906, 0.44277018928890904, 0.4404835229749002, 0.44116121795274277, 0.43726960580966195, 0.4406023994466375, 0.43521436829554855, 0.4372521793933084, 0.4373215174463195, 0.43687805881355013, 0.43377458043207373, 0.4329602918800364, 0.4321618292688718, 0.43086551908914206, 0.4279079286731439, 0.42926343632531044, 0.4270292220230635, 0.43095475087311064, 0.4270304516336034, 0.42906849071156555, 0.4306713123309431, 0.4284137284695195, 0.4289166712518876]
cell_val_scores = [0.053, 0.0169, 0.22935, 0.2151, 0.25545, 0.33375, 0.44775000000000004, 0.3386, 0.39595, 0.5762, 0.48255000000000003, 0.53485, 0.4623, 0.49670000000000003, 0.6002000000000001, 0.5255, 0.6273500000000001, 0.6371, 0.53825, 0.5906, 0.5323, 0.65925, 0.6606000000000001, 0.64205, 0.6134999999999999, 0.6632, 0.6226499999999999, 0.57765, 0.67485, 0.5845, 0.67765, 0.69755, 0.6614, 0.6696500000000001, 0.6788, 0.6951499999999999, 0.6979500000000001, 0.6998500000000001, 0.7108, 0.6632, 0.70425, 0.65825, 0.69315, 0.7048, 0.6928, 0.6869000000000001, 0.6676500000000001, 0.6756500000000001, 0.7115, 0.6764, 0.7109, 0.66635, 0.70535, 0.6890499999999999, 0.6754, 0.6839999999999999, 0.70185, 0.69935, 0.7007, 0.68575, 0.6905, 0.7031499999999999, 0.6828, 0.71565, 0.69895, 0.7037, 0.6978500000000001, 0.7054, 0.7075, 0.6997, 0.7027, 0.6898, 0.7094, 0.6961999999999999, 0.7054, 0.7152000000000001, 0.715, 0.7076, 0.7167, 0.70765, 0.6919, 0.6945, 0.7029000000000001, 0.71665, 0.7092499999999999, 0.702, 0.70485, 0.70585, 0.70835, 0.7060500000000001, 0.70625, 0.7030000000000001, 0.7079, 0.70145, 0.70175, 0.7067, 0.69975, 0.6995, 0.70225, 0.7019500000000001]
```

```{python}
def plot_loss_and_score(training_losses, val_scores):
    fig, ax = plt.subplots(figsize=(8, 5))
    ax2 = ax.twinx()

    ax.plot(training_losses, label="Training Loss", color="b")
    ax.set_xlabel("Epochs")
    ax.set_ylabel("Training Loss", color="b")

    ax2.plot(val_scores, label="Validation Score", color="r")
    ax2.set_ylabel("Validation Score", color="r")
    ax2.grid(False)

    # Creating the legend
    lines, labels = ax.get_legend_handles_labels()
    lines2, labels2 = ax2.get_legend_handles_labels()
    fig.legend(
        lines + lines2,
        labels + labels2,
        loc='upper center',  # Locating it at the upper center of the bounding box
        bbox_to_anchor=(0.85, 1.01),  # Centered horizontally, placed below the axes
    )
    plt.title("Training loss and validation score")
    plt.show()
```

```{python}
plot_loss_and_score(tissue_training_losses, tissue_val_scores)
```

```{python}
plot_loss_and_score(cell_training_losses, cell_val_scores)
```
